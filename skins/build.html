<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
</head>
<body>
	<input type="file" id="fileInput" multiple />
<script>
document.addEventListener('DOMContentLoaded', () => {
	const fileInput = document.getElementById('fileInput');

	fileInput.addEventListener('change', (event) => {
		const files = event.target.files;

		let html = -1;
		let js = -1;
		for (let i = 0; i < files.length; i++) {
			const file = files[i];
			switch (files[i].name) {
				case ".html":
					html = i;
					break;
				case ".js":
					js = i;
					break;
			}
		}
		if (!(html === -1 || js === -1)) {
			console.log("all good!");
			read(html, (result) => {
				let htmlContent = result.split("<script src=\".js\">");;
				console.log(htmlContent[0]);
				console.log(htmlContent[1]);
				read(js, (result) => {
					jsContent = result;
					let build = htmlContent[0].concat("<script>");
					build = build.concat(jsContent);
					build = build.concat(htmlContent[1]);
					download(build);
				});
			});
		}

		function read(index, callback) {
			const file = files[index];
			const reader = new FileReader();

			reader.onload = (e) => {
				// Call the callback function with the result
				callback(e.target.result);
			};

			// Read the file
			reader.readAsText(file);
		}

		function uglify(code) {
			code = code.replace(/\/\/.*/g, '');
			code = code.replace(/\/\*[\s\S]*?\*\//g, '');
			code = code.replace(/\s+/g, ' ');
			return code;
		}

		function download(text) {
			const link = document.createElement('a');
			link.href = URL.createObjectURL(new Blob([text], { type: 'text/html' }));
			link.download = 'index.html';
			document.body.appendChild(link);
			link.click();
			document.body.removeChild(link);
		}
	});
});
</script>
</body>
</html>
