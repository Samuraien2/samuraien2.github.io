<!DOCTYPE html><html><head><title>Heart Attack</title><link rel="icon"href="i.ico"/><style>body{display:flex;justify-content:center;align-items:center;height:100vh;margin:0;background-color:#222}canvas{background-color:#333}</style></head><body><canvas id="c"width="800"height="600"></canvas><script>const ctx=document.getElementById("c").getContext("2d"),gameWidth=800,gameHeight=600,playerSize=36,playerCenter=18,SMALL_ZOMBIE_SIZE=50,LARGE_ZOMBIE_SIZE=200,zombie_rewards=[1,2,2,5,20,5,10],zombie_speeds=[0,0,1.2,1.2,-1.54],TOTAL_ZOMBIES=3,zombie_cooldowntimes=[90,150,230],imageUrls=["skins/heart.png","zombie.png",];let x,y,leftKeyDown=!1,rightKeyDown=!1,upKeyDown=!1,downKeyDown=!1,zombieSpeed=1,playerSpeed=3,gameState=0,zombie_cooldowns=[],zombie_destinations=[],zombie_type=[],zombie_x=[],zombie_y=[],zombie_hp=[],mouseX=0,mouseY=0,score=0,mousePlayerDistance=0,endless=!1;function loadImage(e){return new Promise((o,t)=>{let i=new Image;i.onload=()=>o(i),i.onerror=t,i.src=e})}function titleScreen(){gameState=0}function startGame(){x=382,y=282,gameState=1,score=0,zombie_cooldowns=[...zombie_cooldowntimes],endless=!1,zombieSpeed=.9,playerSpeed=3,gameFrame()}function gameFrame(){ctx.clearRect(0,0,800,600),zombieSpawnTick(),movePlayer(),processZombies(),drawZombies(),drawPlayer(),1===gameState&&requestAnimationFrame(gameFrame)}function zombieSpawnTick(){for(let e=0;e<3;e++)zombie_cooldowns[e]--,0===zombie_cooldowns[e]&&(zombie_cooldowns[e]=zombie_cooldowntimes[e],zombie_type.push(e),1===e?zombie_hp.push(2):2===e?zombie_hp.push(0):zombie_hp.push(1),regularRandomSpawn(Math.floor(4*Math.random())))}function dist(e,o){return Math.sqrt(e*e+o*o)}function touchingZombies(){for(let e=zombie_type.length-1;e>=0;e--)if(mouseTouchingRect(zombie_x[e],zombie_y[e],50,50)){1===zombie_hp[e]||2===zombie_type[e]?(score+=zombie_rewards[zombie_type[e]],console.log(score),killZombie(e)):(zombie_hp[e]--,zombie_type[e]);break}}function killZombie(e){zombie_type.splice(e,1),zombie_x.splice(e,1),zombie_y.splice(e,1),zombie_hp.splice(e,1)}function mouseTouchingRect(e,o,t,i){return!(mouseX<e)&&!(mouseX>e+t)&&!(mouseY<o)&&!(mouseY>o+i)}function squaresTouching(e,o,t,i,m,a){return!(e>i+a)&&!(e+t<i)&&!(o>m+a)&&!(o+t<m)}function movePlayer(){downKeyDown&&(y+=playerSpeed),upKeyDown&&(y-=playerSpeed),leftKeyDown&&(x-=playerSpeed),rightKeyDown&&(x+=playerSpeed),y<0?y=0:y>564&&(y=564),x<0?x=0:x>764&&(x=764)}function regularRandomSpawn(e){switch(e){case 0:zombie_x.push(800*Math.random()),zombie_y.push(-50);break;case 1:zombie_x.push(800*Math.random()),zombie_y.push(600);break;case 2:zombie_x.push(-50),zombie_y.push(600*Math.random());break;default:zombie_x.push(800),zombie_y.push(600*Math.random())}}function changeBrightness(){let e=document.createElement("canvas");e.width=800,e.height=600;let o=e.getContext("2d");o.drawImage(imgs[0],0,0,36,36);let t=o.getImageData(0,0,e.width,e.height),i=t.data;for(let m=0;m<i.length;m+=4)i[m]+=50,i[m+1]+=50,i[m+2]+=50;o.putImageData(t,0,0),playerImage=o.getImageData(0,0,e.width,e.height),ctx.putImageData(playerImage,0,0)}function drawPlayer(){ctx.drawImage(imgs[0],x,y,36,36)}function drawZombies(){for(let e=0;e<zombie_type.length;e++)1===zombie_type[e]&&2===zombie_hp[e]?ctx.fillStyle="#267F00":2===zombie_type[e]?(ctx.globalAlpha=zombie_hp[e]/200,ctx.fillStyle="#FFE97F"):ctx.fillStyle="#2D9900",ctx.fillRect(zombie_x[e],zombie_y[e],50,50),ctx.globalAlpha=1}function damage(){console.log("you took damage")}function processZombies(){let e=zombieSpeed+mousePlayerDistance,o=ctx.getImageData(x,y,36,36),t=o.data;for(let i=0;i<zombie_type.length;i++){let m=5===zombie_type[i]?200:50,a=18-m/2,n=x-zombie_x[i]+a,s=y-zombie_y[i]+a,l=(e+zombie_speeds[zombie_type[i]])/dist(n,s);zombie_x[i]+=l*n,zombie_y[i]+=l*s;let $=ctx.getImageData(zombie_x[i],zombie_y[i],m,m),b=$.data;for(let r=0;r<b.length;r+=4)if(t[r+3]>0&&b[r+3]>0){killZombie(i),damage();break}2===zombie_type[i]&&200!=zombie_hp[i]&&zombie_hp[i]++}}Promise.all(imageUrls.map(e=>loadImage(e))).then(e=>{function o(e){let o=e.keyCode,t="keydown"===e.type;switch(o){case 87:upKeyDown=t;break;case 65:leftKeyDown=t;break;case 83:downKeyDown=t;break;case 68:rightKeyDown=t}}document.body.addEventListener("keydown",o),document.body.addEventListener("keyup",o),document.body.addEventListener("mousedown",()=>{touchingZombies()}),document.body.addEventListener("mousemove",e=>{mouseX=e.offsetX,mouseY=e.offsetY;let o=x+18-mouseX,t=y+18-mouseY;mousePlayerDistance=dist(o,t)/500}),ctx.imageSmoothingEnabled=!1,imgs=e,startGame()});</script></body></html>